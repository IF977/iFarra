<script src="//maps.google.com/maps/api/js?key=AIzaSyDvAQ8rMLvKd3kUCOdnUVvPqMwH5A36Rxs"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script>


<div class="col-md-3">
<h1>Evento:</h1>

<h3>Nome do Evento</h3>
<%=@evento.nome %>

<p><%= image_tag @evento.image.url(:medium) %></p>

<h3>Descrição do Evento</h3>
<%=@evento.descricao %>

<h3>Data e hora de inicio</h3>
<%=@evento.inicio %>

<h3>Data e hora do fim</h3>
<%=@evento.fim %>

<h3>Endereço</h3>
<%=@evento.endereco %>

<h3>Nome do local</h3>
<%=@evento.nome_local %>

<h3>Criador do evento</h3>
<%=@evento.user.email %><br/><br/>

<% if signed_in? %>
	<%= render 'invites/attend_form' %>
<% end %>

<h3>Lista de Confirmdos</h3>
	<% @evento.attendees.each do |attendee| %>
		<p><%= attendee.email %></p>
	<% end %>

<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>

<script type="text/javascript">
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      markers = handler.addMarkers([
        {
          "lat": <%=@evento.latitude%>,
          "lng": <%=@evento.longitude%>,
          "picture": {
            "url": "http://icons.iconarchive.com/icons/paomedia/small-n-flat/32/map-marker-icon.png",
            "width":  32,
            "height": 32
          },
          "infowindow": "<%=@evento.nome_local %>"
        }
      ]);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
      handler.getMap().setZoom(16);
    });
</script>

<h2> <%= @evento.comentario.count %> Comentarios </h2>
</div>
<%= render @evento.comentario %>
<%= render 'comentarios/form' %>

<% if can? :update, @evento %>
    <%=link_to 'Edit', edit_evento_path(@evento)%>
<% end %>

<% if can? :update, @evento %>
    <%=link_to 'Delete', evento_path(@evento), method: :delete, data: {confirm: 'Tem certeza que deseja excluir o evento?'} %>
<% end %>

<%=link_to 'Voltar aos eventos', eventos_path%>
